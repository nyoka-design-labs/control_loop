2024-07-23 11:59:50 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 11:59:50 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 11:59:50 - INFO - stopping pumps
2024-07-23 11:59:50 - INFO - Sending command: b'0pcu1\n'
2024-07-23 11:59:51 - INFO - Sending command: b'2pcu1\n'
2024-07-23 11:59:52 - INFO - Data received from sensor unit:
2024-07-23 11:59:52 - INFO - Sending command: b'14pcu1\n'
2024-07-23 11:59:53 - INFO - Sending command: b'4pcu1\n'
2024-07-23 11:59:54 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 11:59:54 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 11:59:58 - INFO - Data received from sensor unit:
2024-07-23 12:00:25 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:00:25 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:00:25 - INFO - stopping pumps
2024-07-23 12:00:25 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:00:26 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:00:27 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:00:28 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:00:29 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:00:29 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:00:31 - INFO - Data received from sensor unit: {'point': 3}
2024-07-23 12:00:35 - INFO - added data to sheets
2024-07-23 12:01:09 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:01:09 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:01:09 - INFO - stopping pumps
2024-07-23 12:01:09 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:01:10 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:01:11 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:01:12 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:01:13 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:01:13 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:01:42 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:01:42 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:01:42 - INFO - stopping pumps
2024-07-23 12:01:42 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:01:43 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:01:44 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:01:45 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:01:46 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:01:46 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:02:44 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:02:44 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:02:44 - INFO - stopping pumps
2024-07-23 12:02:44 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:02:45 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:02:46 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:02:47 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:02:48 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:02:48 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:03:53 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:03:53 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:03:53 - INFO - stopping pumps
2024-07-23 12:03:53 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:03:54 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:03:55 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:03:56 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:03:57 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:03:57 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:04:51 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:04:51 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:04:51 - INFO - stopping pumps
2024-07-23 12:04:51 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:04:52 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:04:53 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:04:54 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:04:55 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:04:55 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:04:55 - INFO - Data received from sensor unit: {'do': 118.62, 'ph': 6.361, 'temp': 26.461, 'feed_weight': 0.0, 'time': 0, 'date': '23-07-2024', 'time_of_day': '12:04:55', 'type': 'data'}
2024-07-23 12:04:59 - INFO - added data to sheets
2024-07-23 12:05:02 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:05:02 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:05:02 - INFO - Data received from sensor unit: {'do': 118.626, 'ph': 6.36, 'temp': 26.461, 'feed_weight': 0.0, 'time': 0.00193774, 'date': '23-07-2024', 'time_of_day': '12:05:02', 'type': 'data'}
2024-07-23 12:05:05 - INFO - added data to sheets
2024-07-23 12:05:08 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:05:08 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:05:08 - INFO - Data received from sensor unit: {'do': 118.656, 'ph': 6.359, 'temp': 26.46, 'feed_weight': 0.0, 'time': 0.00376472, 'date': '23-07-2024', 'time_of_day': '12:05:08', 'type': 'data'}
2024-07-23 12:05:12 - INFO - added data to sheets
2024-07-23 12:05:15 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:05:15 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:05:15 - INFO - Data received from sensor unit: {'do': 118.665, 'ph': 6.36, 'temp': 26.462, 'feed_weight': 0.0, 'time': 0.00573104, 'date': '23-07-2024', 'time_of_day': '12:05:15', 'type': 'data'}
2024-07-23 12:05:19 - INFO - added data to sheets
2024-07-23 12:06:18 - INFO - recieved ping from frontend
2024-07-23 12:06:38 - INFO - recieved ping from frontend
2024-07-23 12:06:58 - INFO - recieved ping from frontend
2024-07-23 12:07:02 - INFO - Command received: start_collection
2024-07-23 12:07:02 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:07:02 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:07:02 - INFO - stopping pumps
2024-07-23 12:07:02 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:07:03 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:07:04 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:07:05 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:07:06 - INFO - data being collected
2024-07-23 12:07:06 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:07:06 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:07:06 - INFO - Data received from sensor unit: {'do': 118.719, 'ph': 6.357, 'temp': 26.46, 'feed_weight': 0.0, 'time': 0.03649746, 'date': '23-07-2024', 'time_of_day': '12:07:06', 'type': 'data'}
2024-07-23 12:07:10 - INFO - added data to sheets
2024-07-23 12:07:10 - INFO - data sent from collect: {'do': 118.719, 'ph': 6.357, 'temp': 26.46, 'feed_weight': 0.0, 'time': 0.03649746, 'date': '23-07-2024', 'time_of_day': '12:07:06', 'type': 'data'}
2024-07-23 12:07:14 - INFO - data being collected
2024-07-23 12:07:14 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:07:14 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:07:14 - INFO - Data received from sensor unit: {'do': 118.722, 'ph': 6.357, 'temp': 26.461, 'feed_weight': 0.0, 'time': 0.03879135, 'date': '23-07-2024', 'time_of_day': '12:07:15', 'type': 'data'}
2024-07-23 12:07:18 - INFO - added data to sheets
2024-07-23 12:07:18 - INFO - data sent from collect: {'do': 118.722, 'ph': 6.357, 'temp': 26.461, 'feed_weight': 0.0, 'time': 0.03879135, 'date': '23-07-2024', 'time_of_day': '12:07:15', 'type': 'data'}
2024-07-23 12:07:18 - INFO - recieved ping from frontend
2024-07-23 12:07:22 - INFO - data being collected
2024-07-23 12:07:22 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:07:22 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:07:23 - INFO - Data received from sensor unit: {'do': 118.722, 'ph': 6.357, 'temp': 26.459, 'feed_weight': 0.0, 'time': 0.04105749, 'date': '23-07-2024', 'time_of_day': '12:07:23', 'type': 'data'}
2024-07-23 12:07:26 - INFO - added data to sheets
2024-07-23 12:07:26 - INFO - data sent from collect: {'do': 118.722, 'ph': 6.357, 'temp': 26.459, 'feed_weight': 0.0, 'time': 0.04105749, 'date': '23-07-2024', 'time_of_day': '12:07:23', 'type': 'data'}
2024-07-23 12:07:30 - INFO - data being collected
2024-07-23 12:07:30 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:07:30 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:07:31 - INFO - Data received from sensor unit: {'do': 118.739, 'ph': 6.358, 'temp': 26.461, 'feed_weight': 0.0, 'time': 0.04326821, 'date': '23-07-2024', 'time_of_day': '12:07:31', 'type': 'data'}
2024-07-23 12:07:35 - INFO - added data to sheets
2024-07-23 12:07:35 - INFO - data sent from collect: {'do': 118.739, 'ph': 6.358, 'temp': 26.461, 'feed_weight': 0.0, 'time': 0.04326821, 'date': '23-07-2024', 'time_of_day': '12:07:31', 'type': 'data'}
2024-07-23 12:07:35 - INFO - Command received: stop_collection
2024-07-23 12:07:35 - INFO - Collection task was cancelled
2024-07-23 12:07:38 - INFO - recieved ping from frontend
2024-07-23 12:07:59 - INFO - recieved ping from frontend
2024-07-23 12:08:19 - INFO - recieved ping from frontend
2024-07-23 12:08:39 - INFO - recieved ping from frontend
2024-07-23 12:09:08 - INFO - recieved ping from frontend
2024-07-23 12:09:15 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 12:09:15 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 12:09:15 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 12:09:15 - ERROR - Backup Server Starting
2024-07-23 12:09:15 - INFO - stopping pumps
2024-07-23 12:09:15 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:09:53 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-07-23 12:09:53 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 12:09:53 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 12:09:53 - ERROR - Backup Server Starting
2024-07-23 12:09:53 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:09:53 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:09:53 - INFO - stopping pumps
2024-07-23 12:09:53 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:09:55 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:09:56 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:09:57 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:09:58 - INFO - stopping pumps
2024-07-23 12:09:58 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:09:59 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:10:00 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:10:01 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:10:02 - INFO - Controller retrieved, starting backup server.
2024-07-23 12:10:02 - INFO - Starting backup server due to critical failure.
2024-07-23 12:10:02 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 12:10:02 - INFO - back up server running
2024-07-23 12:10:02 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 0, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:10:02 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:10:02 - INFO - Data received from sensor unit: {'do': 118.823, 'ph': 6.356, 'temp': 26.458, 'feed_weight': 0.0, 'time': 0.08527083, 'date': '23-07-2024', 'time_of_day': '12:10:02', 'type': 'data'}
2024-07-23 12:10:02 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:10:03 - INFO - feed_pump pump off
2024-07-23 12:10:03 - INFO - Updated (('last_antifoam_edition', 1721761803.304759), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-07-23 12:10:03 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:10:03 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:10:07 - INFO - added data to sheets
2024-07-23 12:10:07 - INFO - data: {'do': 118.823, 'ph': 6.356, 'temp': 26.458, 'feed_weight': 0.0, 'time': 0.08527083, 'date': '23-07-2024', 'time_of_day': '12:10:02', 'type': 'data'}
2024-07-23 12:10:11 - INFO - back up server running
2024-07-23 12:10:11 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:10:11 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:10:11 - INFO - Data received from sensor unit: {'do': 118.854, 'ph': 6.355, 'temp': 26.458, 'feed_weight': 0.0, 'time': 0.08791608, 'date': '23-07-2024', 'time_of_day': '12:10:11', 'type': 'data'}
2024-07-23 12:10:11 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:10:12 - INFO - feed_pump pump off
2024-07-23 12:10:16 - INFO - added data to sheets
2024-07-23 12:10:16 - INFO - data: {'do': 118.854, 'ph': 6.355, 'temp': 26.458, 'feed_weight': 0.0, 'time': 0.08791608, 'date': '23-07-2024', 'time_of_day': '12:10:11', 'type': 'data'}
2024-07-23 12:10:20 - INFO - back up server running
2024-07-23 12:10:20 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:10:20 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:10:20 - INFO - Data received from sensor unit: {'do': 118.877, 'ph': 6.357, 'temp': 26.459, 'feed_weight': 0.0, 'time': 0.09043103, 'date': '23-07-2024', 'time_of_day': '12:10:20', 'type': 'data'}
2024-07-23 12:10:20 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:10:21 - INFO - feed_pump pump off
2024-07-23 12:10:25 - INFO - added data to sheets
2024-07-23 12:10:25 - INFO - data: {'do': 118.877, 'ph': 6.357, 'temp': 26.459, 'feed_weight': 0.0, 'time': 0.09043103, 'date': '23-07-2024', 'time_of_day': '12:10:20', 'type': 'data'}
2024-07-23 12:10:25 - INFO - stopping pumps
2024-07-23 12:10:25 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:10:26 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:10:27 - INFO - Program terminated by user
2024-07-23 12:17:28 - INFO - Command received: start_collection
2024-07-23 12:17:28 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:17:28 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:17:28 - INFO - stopping pumps
2024-07-23 12:17:28 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:17:30 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:17:31 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:17:32 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:17:33 - INFO - data being collected
2024-07-23 12:17:33 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:17:33 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:17:33 - INFO - Data received from sensor unit: {'do': 118.894, 'ph': 6.356, 'temp': 26.454, 'feed_weight': 0.0, 'time': 0.21053051, 'date': '23-07-2024', 'time_of_day': '12:17:33', 'type': 'data'}
2024-07-23 12:17:38 - INFO - added data to sheets
2024-07-23 12:17:42 - INFO - data being collected
2024-07-23 12:17:42 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:17:42 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:17:42 - INFO - Data received from sensor unit: {'do': 118.942, 'ph': 6.356, 'temp': 26.455, 'feed_weight': 0.0, 'time': 0.21312274, 'date': '23-07-2024', 'time_of_day': '12:17:42', 'type': 'data'}
2024-07-23 12:17:45 - INFO - added data to sheets
2024-07-23 12:17:45 - INFO - recieved ping from frontend
2024-07-23 12:17:49 - INFO - data being collected
2024-07-23 12:17:49 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:17:49 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:17:50 - INFO - Data received from sensor unit: {'do': 118.943, 'ph': 6.356, 'temp': 26.454, 'feed_weight': 0.0, 'time': 0.21519705, 'date': '23-07-2024', 'time_of_day': '12:17:50', 'type': 'data'}
2024-07-23 12:17:53 - INFO - added data to sheets
2024-07-23 12:17:53 - INFO - Command received: stop_collection
2024-07-23 12:17:53 - INFO - Collection task was cancelled
2024-07-23 12:18:05 - INFO - recieved ping from frontend
2024-07-23 12:18:25 - INFO - recieved ping from frontend
2024-07-23 12:18:45 - INFO - recieved ping from frontend
2024-07-23 12:18:47 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 12:18:47 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 12:18:47 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 12:18:47 - ERROR - Backup Server Starting
2024-07-23 12:18:47 - INFO - stopping pumps
2024-07-23 12:18:47 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:18:48 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:18:49 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:24:18 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:24:18 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:24:18 - INFO - stopping pumps
2024-07-23 12:24:18 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:24:19 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:24:20 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:24:21 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:24:22 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:24:22 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:24:31 - INFO - Data received from sensor unit: {'do': 118.789, 'ph': 6.356, 'temp': 26.451, 'feed_weight': 0.0, 'time': 0.32677099, 'date': '23-07-2024', 'time_of_day': '12:24:31', 'type': 'data'}
2024-07-23 12:24:36 - INFO - added data to sheets
2024-07-23 12:26:06 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:26:06 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:26:06 - INFO - stopping pumps
2024-07-23 12:26:06 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:26:07 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:26:08 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:26:09 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:26:10 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:26:10 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:26:10 - INFO - Data received from sensor unit: {'do': 118.839, 'ph': 6.356, 'temp': 26.452, 'feed_weight': 0.0, 'time': 0.35433918, 'date': '23-07-2024', 'time_of_day': '12:26:10', 'type': 'data'}
2024-07-23 12:26:14 - INFO - added data to sheets
2024-07-23 12:26:17 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:26:17 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:26:17 - INFO - Data received from sensor unit: {'do': 118.881, 'ph': 6.356, 'temp': 26.451, 'feed_weight': 0.0, 'time': 0.35627772, 'date': '23-07-2024', 'time_of_day': '12:26:17', 'type': 'data'}
2024-07-23 12:26:21 - INFO - added data to sheets
2024-07-23 12:26:24 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:26:24 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:26:24 - INFO - Data received from sensor unit: {'do': 118.898, 'ph': 6.356, 'temp': 26.452, 'feed_weight': 0.0, 'time': 0.3581621, 'date': '23-07-2024', 'time_of_day': '12:26:24', 'type': 'data'}
2024-07-23 12:26:28 - INFO - added data to sheets
2024-07-23 12:26:31 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:26:31 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:26:31 - INFO - Data received from sensor unit: {'do': 118.878, 'ph': 6.357, 'temp': 26.452, 'feed_weight': 0.0, 'time': 0.35999051, 'date': '23-07-2024', 'time_of_day': '12:26:31', 'type': 'data'}
2024-07-23 12:26:34 - INFO - added data to sheets
2024-07-23 12:26:37 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:26:37 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:26:37 - INFO - Data received from sensor unit: {'do': 118.888, 'ph': 6.357, 'temp': 26.451, 'feed_weight': 0.0, 'time': 0.36184726, 'date': '23-07-2024', 'time_of_day': '12:26:38', 'type': 'data'}
2024-07-23 12:26:41 - INFO - added data to sheets
2024-07-23 12:26:44 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:26:44 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:26:44 - INFO - Data received from sensor unit: {'do': 118.919, 'ph': 6.357, 'temp': 26.452, 'feed_weight': 0.0, 'time': 0.36367709, 'date': '23-07-2024', 'time_of_day': '12:26:44', 'type': 'data'}
2024-07-23 12:26:47 - INFO - added data to sheets
2024-07-23 12:34:21 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:34:21 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:34:21 - INFO - stopping pumps
2024-07-23 12:34:21 - INFO - Sending command: b'0pcu1\n'
2024-07-23 12:34:22 - INFO - Sending command: b'2pcu1\n'
2024-07-23 12:34:23 - INFO - Sending command: b'14pcu1\n'
2024-07-23 12:34:24 - INFO - Sending command: b'4pcu1\n'
2024-07-23 12:34:25 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:34:25 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:34:25 - INFO - Data received from sensor unit: {'do': 118.834, 'ph': 6.357, 'temp': 26.451, 'feed_weight': 0.0, 'time': 0.49177266, 'date': '23-07-2024', 'time_of_day': '12:34:25', 'type': 'data'}
2024-07-23 12:34:29 - INFO - added data to sheets
2024-07-23 12:34:32 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:34:32 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:34:33 - INFO - Data received from sensor unit: {'do': 118.822, 'ph': 6.356, 'temp': 26.452, 'feed_weight': 0.0, 'time': 0.49384636, 'date': '23-07-2024', 'time_of_day': '12:34:33', 'type': 'data'}
2024-07-23 12:34:36 - INFO - added data to sheets
2024-07-23 12:34:39 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:34:39 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 12:34:39 - INFO - Data received from sensor unit: {'do': 118.834, 'ph': 6.356, 'temp': 26.45, 'feed_weight': 0.0, 'time': 0.4956746, 'date': '23-07-2024', 'time_of_day': '12:34:39', 'type': 'data'}
2024-07-23 12:34:43 - INFO - added data to sheets
2024-07-23 12:34:46 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 12:34:46 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:17:44 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-07-23 13:17:44 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 13:17:45 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:17:45 - ERROR - Backup Server Starting
2024-07-23 13:17:45 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:17:45 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:17:45 - INFO - stopping pumps
2024-07-23 13:17:45 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:17:46 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:17:47 - INFO - Sending command: b'14pcu1\n'
2024-07-23 13:17:48 - INFO - Sending command: b'4pcu1\n'
2024-07-23 13:17:49 - INFO - stopping pumps
2024-07-23 13:17:49 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:17:50 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:17:51 - INFO - Sending command: b'14pcu1\n'
2024-07-23 13:17:52 - INFO - Sending command: b'4pcu1\n'
2024-07-23 13:17:53 - INFO - Controller retrieved, starting backup server.
2024-07-23 13:17:53 - INFO - Starting backup server due to critical failure.
2024-07-23 13:17:53 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:17:53 - INFO - back up server running
2024-07-23 13:17:53 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:17:53 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:17:53 - INFO - Data received from sensor unit: {'do': 119.16, 'ph': 6.355, 'temp': 26.486, 'feed_weight': 0.0, 'time': 1.21612547, 'date': '23-07-2024', 'time_of_day': '13:17:53', 'type': 'data'}
2024-07-23 13:17:53 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:17:54 - INFO - feed_pump pump off
2024-07-23 13:17:54 - INFO - Sending command: b'5pcu1\n'
2024-07-23 13:17:55 - INFO - Antifoam pump activated
2024-07-23 13:18:00 - INFO - stopping pumps
2024-07-23 13:18:00 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:18:01 - INFO - Program terminated by user
2024-07-23 13:18:09 - INFO - Command received: start_collection
2024-07-23 13:18:09 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:18:09 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:18:10 - INFO - stopping pumps
2024-07-23 13:18:10 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:18:11 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:18:12 - INFO - Sending command: b'14pcu1\n'
2024-07-23 13:18:13 - INFO - Sending command: b'4pcu1\n'
2024-07-23 13:18:14 - INFO - data being collected
2024-07-23 13:18:14 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:18:14 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:18:14 - INFO - Data received from sensor unit: {'do': 119.145, 'ph': 6.356, 'temp': 26.488, 'feed_weight': 0.0, 'time': 1.221936, 'date': '23-07-2024', 'time_of_day': '13:18:14', 'type': 'data'}
2024-07-23 13:18:19 - INFO - added data to sheets
2024-07-23 13:18:23 - INFO - data being collected
2024-07-23 13:18:23 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:18:23 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:18:23 - INFO - Data received from sensor unit: {'do': 119.118, 'ph': 6.355, 'temp': 26.487, 'feed_weight': 0.0, 'time': 1.2245269, 'date': '23-07-2024', 'time_of_day': '13:18:23', 'type': 'data'}
2024-07-23 13:18:28 - INFO - added data to sheets
2024-07-23 13:18:28 - INFO - recieved ping from frontend
2024-07-23 13:18:29 - INFO - Command received: stop_collection
2024-07-23 13:18:30 - INFO - Collection task was cancelled
2024-07-23 13:18:45 - INFO - recieved ping from frontend
2024-07-23 13:19:05 - INFO - recieved ping from frontend
2024-07-23 13:19:25 - INFO - recieved ping from frontend
2024-07-23 13:19:45 - INFO - recieved ping from frontend
2024-07-23 13:20:05 - INFO - recieved ping from frontend
2024-07-23 13:20:25 - INFO - recieved ping from frontend
2024-07-23 13:20:45 - INFO - recieved ping from frontend
2024-07-23 13:21:05 - INFO - recieved ping from frontend
2024-07-23 13:21:25 - INFO - recieved ping from frontend
2024-07-23 13:21:45 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 13:21:45 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 13:21:45 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:21:45 - ERROR - Backup Server Starting
2024-07-23 13:21:45 - INFO - stopping pumps
2024-07-23 13:21:45 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:21:50 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-07-23 13:21:50 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 13:21:50 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:21:50 - ERROR - Backup Server Starting
2024-07-23 13:21:50 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:21:50 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:21:50 - INFO - stopping pumps
2024-07-23 13:21:50 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:21:51 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:21:52 - INFO - Sending command: b'14pcu1\n'
2024-07-23 13:21:53 - INFO - Sending command: b'4pcu1\n'
2024-07-23 13:21:54 - INFO - stopping pumps
2024-07-23 13:21:54 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:21:55 - INFO - Program terminated by user
2024-07-23 13:22:23 - INFO - Command received: start_collection
2024-07-23 13:22:23 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:22:23 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:22:23 - INFO - stopping pumps
2024-07-23 13:22:23 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:22:24 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:22:25 - INFO - Sending command: b'14pcu1\n'
2024-07-23 13:22:26 - INFO - Sending command: b'4pcu1\n'
2024-07-23 13:22:27 - INFO - data being collected
2024-07-23 13:22:27 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:22:27 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:22:27 - INFO - Data received from sensor unit: {'do': 119.183, 'ph': 6.354, 'temp': 26.494, 'feed_weight': 0.0, 'time': 1.29226208, 'date': '23-07-2024', 'time_of_day': '13:22:27', 'type': 'data'}
2024-07-23 13:22:32 - INFO - added data to sheets
2024-07-23 13:22:36 - INFO - data being collected
2024-07-23 13:22:36 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:22:36 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:22:36 - INFO - Data received from sensor unit: {'do': 119.194, 'ph': 6.355, 'temp': 26.496, 'feed_weight': 0.0, 'time': 1.29485375, 'date': '23-07-2024', 'time_of_day': '13:22:36', 'type': 'data'}
2024-07-23 13:22:41 - INFO - added data to sheets
2024-07-23 13:22:41 - INFO - recieved ping from frontend
2024-07-23 13:22:45 - INFO - data being collected
2024-07-23 13:22:45 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:22:45 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:22:45 - INFO - Data received from sensor unit: {'do': 119.18, 'ph': 6.355, 'temp': 26.495, 'feed_weight': 0.0, 'time': 1.29731062, 'date': '23-07-2024', 'time_of_day': '13:22:45', 'type': 'data'}
2024-07-23 13:22:49 - INFO - added data to sheets
2024-07-23 13:22:53 - INFO - data being collected
2024-07-23 13:22:53 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:22:53 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:22:53 - INFO - Data received from sensor unit: {'do': 119.18, 'ph': 6.355, 'temp': 26.495, 'feed_weight': 0.0, 'time': 1.29959991, 'date': '23-07-2024', 'time_of_day': '13:22:53', 'type': 'data'}
2024-07-23 13:22:58 - INFO - added data to sheets
2024-07-23 13:22:58 - INFO - Command received: toggle_feed_pump
2024-07-23 13:22:59 - INFO - recieved ping from frontend
2024-07-23 13:23:02 - INFO - data being collected
2024-07-23 13:23:02 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:23:02 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:23:02 - INFO - Data received from sensor unit: {'do': 119.185, 'ph': 6.354, 'temp': 26.495, 'feed_weight': 0.0, 'time': 1.3020822, 'date': '23-07-2024', 'time_of_day': '13:23:02', 'type': 'data'}
2024-07-23 13:23:07 - INFO - added data to sheets
2024-07-23 13:23:07 - INFO - Command received: stop_collection
2024-07-23 13:23:07 - INFO - Collection task was cancelled
2024-07-23 13:23:19 - INFO - recieved ping from frontend
2024-07-23 13:23:39 - INFO - recieved ping from frontend
2024-07-23 13:23:59 - INFO - recieved ping from frontend
2024-07-23 13:24:19 - INFO - recieved ping from frontend
2024-07-23 13:24:39 - INFO - recieved ping from frontend
2024-07-23 13:24:59 - INFO - recieved ping from frontend
2024-07-23 13:25:19 - INFO - recieved ping from frontend
2024-07-23 13:25:39 - INFO - recieved ping from frontend
2024-07-23 13:25:59 - INFO - recieved ping from frontend
2024-07-23 13:26:19 - INFO - recieved ping from frontend
2024-07-23 13:26:36 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 13:26:36 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 13:26:36 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:26:36 - ERROR - Backup Server Starting
2024-07-23 13:26:36 - INFO - stopping pumps
2024-07-23 13:26:36 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:26:51 - INFO - Command received: toggle_feed_pump
2024-07-23 13:26:51 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:26:51 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:26:51 - INFO - stopping pumps
2024-07-23 13:26:51 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:26:52 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:26:53 - INFO - Sending command: b'14pcu1\n'
2024-07-23 13:26:54 - INFO - Sending command: b'4pcu1\n'
2024-07-23 13:27:04 - INFO - Command received: toggle_feed_pump
2024-07-23 13:27:08 - INFO - recieved ping from frontend
2024-07-23 13:27:15 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 13:27:15 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 13:27:15 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:27:15 - ERROR - Backup Server Starting
2024-07-23 13:27:15 - INFO - stopping pumps
2024-07-23 13:27:15 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:28:20 - ERROR - Error in send_config_data
Unexpected error: no close frame received or sent
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 59, in send_config_data
    await websocket.send(json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 647, in send
    await self.write_frame(True, opcode, data)
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1209, in write_frame
    await self.drain()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1198, in drain
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent

2024-07-23 13:28:20 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedError'>
2024-07-23 13:28:25 - INFO - Command received: toggle_feed_pump
2024-07-23 13:28:25 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:28:25 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:28:26 - INFO - stopping pumps
2024-07-23 13:28:26 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:28:27 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:28:28 - INFO - Sending command: b'14pcu1\n'
2024-07-23 13:28:29 - INFO - Sending command: b'4pcu1\n'
2024-07-23 13:29:23 - INFO - Command received: toggle_feed_pump
2024-07-23 13:29:23 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:29:23 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:29:23 - INFO - stopping pumps
2024-07-23 13:29:23 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:29:24 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:29:25 - INFO - Sending command: b'14pcu1\n'
2024-07-23 13:29:26 - INFO - Sending command: b'4pcu1\n'
2024-07-23 13:29:32 - INFO - Sending command: b'1pcu1\n'
2024-07-23 13:29:39 - INFO - recieved ping from frontend
2024-07-23 13:29:42 - INFO - Command received: toggle_feed_pump
2024-07-23 13:29:42 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:29:44 - INFO - Command received: toggle_base_pump
2024-07-23 13:29:44 - INFO - Sending command: b'3pcu1\n'
2024-07-23 13:29:47 - INFO - Command received: toggle_base_pump
2024-07-23 13:29:47 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:29:55 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 13:29:55 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 13:29:55 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:29:55 - ERROR - Backup Server Starting
2024-07-23 13:29:55 - INFO - stopping pumps
2024-07-23 13:29:55 - INFO - Sending command: b'0pcu1\n'
2024-07-23 13:29:56 - INFO - Sending command: b'2pcu1\n'
2024-07-23 13:30:45 - INFO - Program terminated by user
2024-07-23 13:31:25 - INFO - recieved ping from frontend
2024-07-23 13:31:45 - INFO - recieved ping from frontend
2024-07-23 13:31:50 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 13:31:50 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 13:31:50 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:31:50 - ERROR - Backup Server Starting
2024-07-23 13:31:50 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:31:50 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:31:50 - ERROR - Error in get_controller: 
 Input: fermentation_loop, 
 [Errno 51] Network is unreachable
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/manager_server.py", line 266, in get_controller
    controller = c.create_controller(loop_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 41, in create_controller
    controller = FermentationController()
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 529, in __init__
    self.mqtt_client = ControllerMQTTClient(broker_address="192.168.0.25")
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controller_mqtt_client.py", line 12, in __init__
    self.client.connect(broker_address, 1883, 60)
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1435, in connect
    return self.reconnect()
           ^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1598, in reconnect
    self._sock = self._create_socket()
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 4609, in _create_socket
    sock = self._create_socket_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 4640, in _create_socket_connection
    return socket.create_connection(addr, timeout=self._connect_timeout, source_address=source)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socket.py", line 853, in create_connection
    raise exceptions[0]
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socket.py", line 838, in create_connection
    sock.connect(sa)
OSError: [Errno 51] Network is unreachable

2024-07-23 13:31:50 - ERROR - Error in handle_server_error
Unexpected error: argument of type 'NoneType' is not iterable
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 229, in handle_server_error
    controller = await manager_server.stop_all(loop_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/manager_server.py", line 189, in stop_all
    if "control_task" in controller_info:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument of type 'NoneType' is not iterable

2024-07-23 13:31:50 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 13:31:50 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 127, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 229, in handle_server_error
    controller = await manager_server.stop_all(loop_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/manager_server.py", line 189, in stop_all
    if "control_task" in controller_info:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument of type 'NoneType' is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 13:31:50 - INFO - Program terminated by user
2024-07-23 13:31:58 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:31:58 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 13:32:07 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 13:32:07 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:06:01 - ERROR - Error in start_server
Unexpected error: 'NoneType' object has no attribute 'on_connect'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 267, in main
    setup_mqtt()
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 56, in setup_mqtt
    mqtt_client.on_connect = on_connect
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'on_connect'

2024-07-23 14:06:01 - ERROR - type of exception: <class 'AttributeError'>
2024-07-23 14:06:01 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 267, in main
    setup_mqtt()
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 56, in setup_mqtt
    mqtt_client.on_connect = on_connect
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'on_connect'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:06:06 - ERROR - Error in start_server
Unexpected error: 'NoneType' object has no attribute 'on_connect'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 267, in main
    setup_mqtt()
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 56, in setup_mqtt
    mqtt_client.on_connect = on_connect
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'on_connect'

2024-07-23 14:06:06 - ERROR - type of exception: <class 'AttributeError'>
2024-07-23 14:06:06 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 267, in main
    setup_mqtt()
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 56, in setup_mqtt
    mqtt_client.on_connect = on_connect
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'on_connect'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:09:42 - INFO - Program terminated by user
2024-07-23 14:10:22 - INFO - Program terminated by user
2024-07-23 14:10:23 - INFO - Connected to MQTT broker
2024-07-23 14:11:57 - ERROR - Error in send_pump_data
Unexpected error: on_publish() takes 3 positional arguments but 5 were given
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 101, in send_pump_data
    mqtt_client.publish("button_setup", json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1774, in publish
    rc = self._send_publish(
         ^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3444, in _send_publish
    return self._packet_queue(PUBLISH, packet, mid, qos, info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3791, in _packet_queue
    return self.loop_write()
           ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 2121, in loop_write
    rc = self._packet_write()
         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3201, in _packet_write
    on_publish(
TypeError: on_publish() takes 3 positional arguments but 5 were given

2024-07-23 14:11:57 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 14:11:57 - ERROR - Error in send_config_data
Unexpected error: on_publish() takes 3 positional arguments but 5 were given
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 77, in send_config_data
    mqtt_client.publish("config_setup", json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1774, in publish
    rc = self._send_publish(
         ^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3444, in _send_publish
    return self._packet_queue(PUBLISH, packet, mid, qos, info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3791, in _packet_queue
    return self.loop_write()
           ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 2121, in loop_write
    rc = self._packet_write()
         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3201, in _packet_write
    on_publish(
TypeError: on_publish() takes 3 positional arguments but 5 were given

2024-07-23 14:11:57 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 14:12:14 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:12:14 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:12:14 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:12:14 - ERROR - Backup Server Starting
2024-07-23 14:12:14 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:12:14 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:12:14 - INFO - stopping pumps
2024-07-23 14:12:14 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:12:32 - INFO - Connected to MQTT broker
2024-07-23 14:12:35 - ERROR - Error in send_config_data
Unexpected error: on_publish() takes 3 positional arguments but 5 were given
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 77, in send_config_data
    mqtt_client.publish("config_setup", json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1774, in publish
    rc = self._send_publish(
         ^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3444, in _send_publish
    return self._packet_queue(PUBLISH, packet, mid, qos, info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3791, in _packet_queue
    return self.loop_write()
           ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 2121, in loop_write
    rc = self._packet_write()
         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3201, in _packet_write
    on_publish(
TypeError: on_publish() takes 3 positional arguments but 5 were given

2024-07-23 14:12:35 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 14:12:35 - ERROR - Error in send_pump_data
Unexpected error: on_publish() takes 3 positional arguments but 5 were given
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 101, in send_pump_data
    mqtt_client.publish("button_setup", json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1774, in publish
    rc = self._send_publish(
         ^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3444, in _send_publish
    return self._packet_queue(PUBLISH, packet, mid, qos, info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3791, in _packet_queue
    return self.loop_write()
           ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 2121, in loop_write
    rc = self._packet_write()
         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3201, in _packet_write
    on_publish(
TypeError: on_publish() takes 3 positional arguments but 5 were given

2024-07-23 14:12:35 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 14:12:35 - ERROR - Error in send_config_data
Unexpected error: on_publish() takes 3 positional arguments but 5 were given
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 77, in send_config_data
    mqtt_client.publish("config_setup", json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1774, in publish
    rc = self._send_publish(
         ^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3444, in _send_publish
    return self._packet_queue(PUBLISH, packet, mid, qos, info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3791, in _packet_queue
    return self.loop_write()
           ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 2121, in loop_write
    rc = self._packet_write()
         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3201, in _packet_write
    on_publish(
TypeError: on_publish() takes 3 positional arguments but 5 were given

2024-07-23 14:12:35 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 14:12:35 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-07-23 14:12:35 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:12:36 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:12:36 - ERROR - Backup Server Starting
2024-07-23 14:12:36 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:12:36 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:12:36 - INFO - stopping pumps
2024-07-23 14:12:36 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:12:37 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:12:38 - INFO - Sending command: b'14pcu1\n'
2024-07-23 14:12:39 - INFO - Sending command: b'4pcu1\n'
2024-07-23 14:12:40 - INFO - stopping pumps
2024-07-23 14:12:40 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:12:41 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:12:42 - INFO - Sending command: b'14pcu1\n'
2024-07-23 14:12:43 - INFO - Sending command: b'4pcu1\n'
2024-07-23 14:12:44 - INFO - Controller retrieved, starting backup server.
2024-07-23 14:12:44 - INFO - Starting backup server due to critical failure.
2024-07-23 14:12:44 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:12:44 - INFO - back up server running
2024-07-23 14:12:44 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:12:44 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:12:44 - INFO - Data received from sensor unit: {'do': 119.148, 'ph': 6.353, 'temp': 26.601, 'feed_weight': 0.0, 'time': 2.1302956, 'date': '23-07-2024', 'time_of_day': '14:12:44', 'type': 'data'}
2024-07-23 14:12:44 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:12:45 - INFO - stopping pumps
2024-07-23 14:12:45 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:12:45 - INFO - Program terminated by user
2024-07-23 14:12:51 - INFO - Connected to MQTT broker
2024-07-23 14:12:54 - ERROR - Error in send_config_data
Unexpected error: on_publish() takes 3 positional arguments but 5 were given
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 77, in send_config_data
    mqtt_client.publish("config_setup", json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1774, in publish
    rc = self._send_publish(
         ^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3444, in _send_publish
    return self._packet_queue(PUBLISH, packet, mid, qos, info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3791, in _packet_queue
    return self.loop_write()
           ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 2121, in loop_write
    rc = self._packet_write()
         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3201, in _packet_write
    on_publish(
TypeError: on_publish() takes 3 positional arguments but 5 were given

2024-07-23 14:12:54 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 14:12:54 - ERROR - Error in send_pump_data
Unexpected error: on_publish() takes 3 positional arguments but 5 were given
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 101, in send_pump_data
    mqtt_client.publish("button_setup", json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1774, in publish
    rc = self._send_publish(
         ^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3444, in _send_publish
    return self._packet_queue(PUBLISH, packet, mid, qos, info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3791, in _packet_queue
    return self.loop_write()
           ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 2121, in loop_write
    rc = self._packet_write()
         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3201, in _packet_write
    on_publish(
TypeError: on_publish() takes 3 positional arguments but 5 were given

2024-07-23 14:12:54 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 14:12:54 - ERROR - Error in send_config_data
Unexpected error: on_publish() takes 3 positional arguments but 5 were given
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 77, in send_config_data
    mqtt_client.publish("config_setup", json.dumps({
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 1774, in publish
    rc = self._send_publish(
         ^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3444, in _send_publish
    return self._packet_queue(PUBLISH, packet, mid, qos, info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3791, in _packet_queue
    return self.loop_write()
           ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 2121, in loop_write
    rc = self._packet_write()
         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/paho/mqtt/client.py", line 3201, in _packet_write
    on_publish(
TypeError: on_publish() takes 3 positional arguments but 5 were given

2024-07-23 14:12:54 - ERROR - type of exception: <class 'TypeError'>
2024-07-23 14:13:14 - INFO - received ping from frontend
2024-07-23 14:13:34 - INFO - received ping from frontend
2024-07-23 14:13:54 - INFO - received ping from frontend
2024-07-23 14:14:01 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:14:01 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:14:02 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:14:02 - ERROR - Backup Server Starting
2024-07-23 14:14:02 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:14:02 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:14:02 - INFO - stopping pumps
2024-07-23 14:14:02 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:14:05 - INFO - Connected to MQTT broker
2024-07-23 14:14:10 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:14:10 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:14:10 - INFO - Message published with mid: 3, properties: Success, reasonCode: []
2024-07-23 14:14:10 - INFO - Message published with mid: 4, properties: Success, reasonCode: []
2024-07-23 14:14:10 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-07-23 14:14:10 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:14:10 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 143, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:14:10 - ERROR - Backup Server Starting
2024-07-23 14:14:10 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:14:10 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:14:10 - INFO - stopping pumps
2024-07-23 14:14:10 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:14:11 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:14:12 - INFO - Sending command: b'14pcu1\n'
2024-07-23 14:14:13 - INFO - Sending command: b'4pcu1\n'
2024-07-23 14:14:14 - INFO - stopping pumps
2024-07-23 14:14:14 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:14:14 - INFO - Program terminated by user
2024-07-23 14:15:53 - INFO - Connected to MQTT broker
2024-07-23 14:16:14 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:16:14 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:16:17 - INFO - Message published with mid: 3, properties: Success, reasonCode: []
2024-07-23 14:16:21 - INFO - Message published with mid: 4, properties: Success, reasonCode: []
2024-07-23 14:17:06 - INFO - Connected to MQTT broker
2024-07-23 14:17:21 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:17:28 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:18:41 - INFO - Connected to MQTT broker
2024-07-23 14:18:50 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:18:52 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:20:05 - INFO - Connected to MQTT broker
2024-07-23 14:20:13 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:20:14 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:20:40 - INFO - received ping from frontend
2024-07-23 14:21:00 - INFO - received ping from frontend
2024-07-23 14:21:05 - ERROR - Error in handle_client
Unexpected error: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

2024-07-23 14:21:05 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:21:06 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:21:06 - ERROR - Backup Server Starting
2024-07-23 14:21:06 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:21:06 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:21:06 - INFO - stopping pumps
2024-07-23 14:21:06 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:21:07 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:21:08 - INFO - Sending command: b'14pcu1\n'
2024-07-23 14:21:09 - INFO - Sending command: b'4pcu1\n'
2024-07-23 14:21:10 - INFO - stopping pumps
2024-07-23 14:21:10 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:21:11 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:21:12 - INFO - Sending command: b'14pcu1\n'
2024-07-23 14:21:13 - INFO - Sending command: b'4pcu1\n'
2024-07-23 14:21:14 - INFO - Controller retrieved, starting backup server.
2024-07-23 14:21:14 - INFO - Starting backup server due to critical failure.
2024-07-23 14:21:14 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:21:14 - INFO - back up server running
2024-07-23 14:21:14 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:21:14 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:21:14 - INFO - Data received from sensor unit: {'do': 119.009, 'ph': 6.353, 'temp': 26.621, 'feed_weight': 0.0, 'time': 2.27199157, 'date': '23-07-2024', 'time_of_day': '14:21:14', 'type': 'data'}
2024-07-23 14:21:14 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:21:15 - INFO - feed_pump pump off
2024-07-23 14:21:15 - INFO - Sending command: b'5pcu1\n'
2024-07-23 14:21:16 - INFO - Antifoam pump activated
2024-07-23 14:21:22 - INFO - added data to sheets
2024-07-23 14:21:22 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/backup_server.py", line 56, in control_task
    data, status = controller.start_control()
    ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:21:22 - ERROR - Error in backup server control_task: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/backup_server.py", line 56, in control_task
    data, status = controller.start_control()
    ^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2024-07-23 14:21:22 - ERROR - Backup Server Started
2024-07-23 14:21:22 - INFO - Program terminated by user
2024-07-23 14:23:52 - INFO - Connected to MQTT broker
2024-07-23 14:23:56 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:23:56 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:24:16 - INFO - received ping from frontend
2024-07-23 14:24:36 - INFO - received ping from frontend
2024-07-23 14:24:56 - INFO - received ping from frontend
2024-07-23 14:25:16 - INFO - received ping from frontend
2024-07-23 14:25:36 - INFO - received ping from frontend
2024-07-23 14:25:56 - INFO - received ping from frontend
2024-07-23 14:26:16 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    if data.get("type") == "ping":
              ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:26:16 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:26:16 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    if data.get("type") == "ping":
              ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:26:16 - ERROR - Backup Server Starting
2024-07-23 14:26:16 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:26:16 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:26:16 - INFO - stopping pumps
2024-07-23 14:26:16 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:26:19 - INFO - Connected to MQTT broker
2024-07-23 14:26:27 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:26:27 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:26:47 - INFO - received ping from frontend
2024-07-23 14:27:07 - INFO - received ping from frontend
2024-07-23 14:27:27 - INFO - received ping from frontend
2024-07-23 14:27:47 - INFO - received ping from frontend
2024-07-23 14:27:50 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    while True:
                
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:27:50 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:27:50 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    while True:
                
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:27:50 - ERROR - Backup Server Starting
2024-07-23 14:27:50 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:27:50 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:27:50 - INFO - stopping pumps
2024-07-23 14:27:50 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:28:17 - INFO - Connected to MQTT broker
2024-07-23 14:28:27 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:28:27 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:28:36 - INFO - Command received: start_collection
2024-07-23 14:28:36 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:28:36 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:28:36 - INFO - stopping pumps
2024-07-23 14:28:36 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:28:37 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:28:38 - INFO - Sending command: b'14pcu1\n'
2024-07-23 14:28:39 - INFO - Sending command: b'4pcu1\n'
2024-07-23 14:28:40 - INFO - data being collected
2024-07-23 14:28:40 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:28:40 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:28:41 - INFO - Data received from sensor unit: {'do': 119.185, 'ph': 6.353, 'temp': 26.678, 'feed_weight': 0.0, 'time': 2.39594482, 'date': '23-07-2024', 'time_of_day': '14:28:40', 'type': 'data'}
2024-07-23 14:28:46 - INFO - added data to sheets
2024-07-23 14:28:47 - INFO - received ping from frontend
2024-07-23 14:28:50 - INFO - data being collected
2024-07-23 14:28:50 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:28:50 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:28:51 - INFO - Data received from sensor unit: {'do': 119.212, 'ph': 6.353, 'temp': 26.68, 'feed_weight': 0.0, 'time': 2.39881139, 'date': '23-07-2024', 'time_of_day': '14:28:51', 'type': 'data'}
2024-07-23 14:28:54 - INFO - added data to sheets
2024-07-23 14:28:56 - INFO - Command received: stop_collection
2024-07-23 14:28:56 - INFO - Collection task was cancelled
2024-07-23 14:29:07 - INFO - received ping from frontend
2024-07-23 14:29:27 - INFO - received ping from frontend
2024-07-23 14:29:47 - INFO - received ping from frontend
2024-07-23 14:30:07 - INFO - received ping from frontend
2024-07-23 14:30:27 - INFO - received ping from frontend
2024-07-23 14:30:47 - INFO - received ping from frontend
2024-07-23 14:31:07 - INFO - received ping from frontend
2024-07-23 14:31:18 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 147, in handle_client
    if data.get("type") == "ping":
              ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:31:18 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:31:18 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 147, in handle_client
    if data.get("type") == "ping":
              ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:31:18 - ERROR - Backup Server Starting
2024-07-23 14:31:18 - INFO - stopping pumps
2024-07-23 14:31:18 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:31:20 - INFO - Connected to MQTT broker
2024-07-23 14:31:29 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:31:29 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:31:49 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 145, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:31:49 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:31:50 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 145, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:31:50 - ERROR - Backup Server Starting
2024-07-23 14:31:50 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:31:50 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:32:14 - INFO - Connected to MQTT broker
2024-07-23 14:32:59 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:33:01 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:34:05 - INFO - Connected to MQTT broker
2024-07-23 14:34:13 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:34:13 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:34:25 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 145, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:34:25 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:34:25 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 145, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:34:25 - ERROR - Backup Server Starting
2024-07-23 14:34:25 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:34:25 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:34:25 - INFO - stopping pumps
2024-07-23 14:34:25 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:34:38 - INFO - Connected to MQTT broker
2024-07-23 14:34:50 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:34:50 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:35:03 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 145, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:35:03 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:35:03 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 145, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:35:03 - ERROR - Backup Server Starting
2024-07-23 14:35:03 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:35:03 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:35:03 - INFO - stopping pumps
2024-07-23 14:35:03 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:35:14 - INFO - Connected to MQTT broker
2024-07-23 14:35:25 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:35:25 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:35:45 - INFO - received ping from frontend
2024-07-23 14:36:05 - INFO - received ping from frontend
2024-07-23 14:36:25 - INFO - received ping from frontend
2024-07-23 14:36:31 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 145, in handle_client
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:36:31 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:36:31 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 145, in handle_client
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:36:31 - ERROR - Backup Server Starting
2024-07-23 14:36:31 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:36:31 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:36:31 - INFO - stopping pumps
2024-07-23 14:36:31 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:36:39 - INFO - Connected to MQTT broker
2024-07-23 14:36:43 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:36:44 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:36:53 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-07-23 14:36:53 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:36:53 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:36:53 - ERROR - Backup Server Starting
2024-07-23 14:36:53 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:36:53 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:36:53 - INFO - stopping pumps
2024-07-23 14:36:53 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:36:54 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:36:55 - INFO - Sending command: b'14pcu1\n'
2024-07-23 14:36:56 - INFO - Sending command: b'4pcu1\n'
2024-07-23 14:36:56 - ERROR - Error in handle_client
Unexpected error: no close frame received or sent
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1987, in _run_once
    handle._run()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/server.py", line 236, in handler
    await self.ws_handler(self)
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 163, in handle_client
    await handle_server_error()
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 244, in handle_server_error
    controller = await manager_server.stop_all(loop_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/manager_server.py", line 185, in stop_all
    controller_info = get_controller(loop_id)
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/manager_server.py", line 266, in get_controller
    controller = c.create_controller(loop_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 41, in create_controller
    controller = FermentationController()
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 536, in __init__
    self.stop_control(data_col_is_on=False)
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 178, in stop_control
    self.pump_control(pump.control(False))
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 97, in pump_control
    time.sleep(1)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 963, in transfer_data
    message = await self.read_message()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1033, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1108, in read_data_frame
    frame = await self.read_frame(max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1165, in read_frame
    frame = await Frame.read(
            ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/framing.py", line 68, in read
    data = await reader(2)
           ^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/streams.py", line 752, in readexactly
    await self._wait_for_data('readexactly')
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py", line 1013, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 54] Connection reset by peer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent

2024-07-23 14:36:56 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedError'>
2024-07-23 14:36:56 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1987, in _run_once
    handle._run()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/server.py", line 236, in handler
    await self.ws_handler(self)
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 163, in handle_client
    await handle_server_error()
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 244, in handle_server_error
    controller = await manager_server.stop_all(loop_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/manager_server.py", line 185, in stop_all
    controller_info = get_controller(loop_id)
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/manager_server.py", line 266, in get_controller
    controller = c.create_controller(loop_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 41, in create_controller
    controller = FermentationController()
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 536, in __init__
    self.stop_control(data_col_is_on=False)
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 178, in stop_control
    self.pump_control(pump.control(False))
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/controllers_mqtt.py", line 97, in pump_control
    time.sleep(1)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 963, in transfer_data
    message = await self.read_message()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1033, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1108, in read_data_frame
    frame = await self.read_frame(max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 1165, in read_frame
    frame = await Frame.read(
            ^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/framing.py", line 68, in read
    data = await reader(2)
           ^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/streams.py", line 752, in readexactly
    await self._wait_for_data('readexactly')
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/streams.py", line 545, in _wait_for_data
    await self._waiter
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py", line 1013, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 54] Connection reset by peer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:36:56 - ERROR - Backup Server Starting
2024-07-23 14:36:56 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:36:56 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:36:56 - INFO - stopping pumps
2024-07-23 14:36:56 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:36:57 - INFO - Program terminated by user
2024-07-23 14:39:08 - INFO - Connected to MQTT broker
2024-07-23 14:39:17 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:39:17 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:39:38 - INFO - received ping from frontend
2024-07-23 14:39:58 - INFO - received ping from frontend
2024-07-23 14:40:18 - INFO - received ping from frontend
2024-07-23 14:40:38 - INFO - received ping from frontend
2024-07-23 14:40:58 - INFO - received ping from frontend
2024-07-23 14:41:18 - INFO - received ping from frontend
2024-07-23 14:41:38 - INFO - received ping from frontend
2024-07-23 14:41:58 - INFO - received ping from frontend
2024-07-23 14:42:18 - INFO - received ping from frontend
2024-07-23 14:42:36 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    if data.get("type") == "ping":
              ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:42:36 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:42:36 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 148, in handle_client
    if data.get("type") == "ping":
              ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:42:36 - ERROR - Backup Server Starting
2024-07-23 14:42:36 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:42:36 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:42:36 - INFO - stopping pumps
2024-07-23 14:42:36 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:43:04 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:43:04 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:43:04 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:43:04 - ERROR - Backup Server Starting
2024-07-23 14:43:04 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:43:04 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:43:04 - INFO - stopping pumps
2024-07-23 14:43:04 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:43:15 - INFO - Connected to MQTT broker
2024-07-23 14:43:19 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:43:20 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:43:39 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:43:39 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:43:39 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:43:39 - ERROR - Backup Server Starting
2024-07-23 14:43:39 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:43:39 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:43:39 - INFO - stopping pumps
2024-07-23 14:43:39 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:43:55 - INFO - Connected to MQTT broker
2024-07-23 14:44:00 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:44:14 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:45:08 - INFO - Connected to MQTT broker
2024-07-23 14:45:12 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:45:12 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:45:30 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:45:30 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:45:30 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:45:30 - ERROR - Backup Server Starting
2024-07-23 14:45:30 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:45:30 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:45:30 - INFO - stopping pumps
2024-07-23 14:45:30 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:45:42 - INFO - Connected to MQTT broker
2024-07-23 14:45:46 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:45:51 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:46:26 - INFO - received ping from frontend
2024-07-23 14:46:32 - INFO - received ping from frontend
2024-07-23 14:46:38 - INFO - Connected to MQTT broker
2024-07-23 14:46:49 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:46:52 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:47:14 - INFO - Connected to MQTT broker
2024-07-23 14:47:16 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:47:17 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:47:33 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:47:33 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:47:33 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:47:33 - ERROR - Backup Server Starting
2024-07-23 14:47:33 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:47:33 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:47:33 - INFO - stopping pumps
2024-07-23 14:47:33 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:48:48 - INFO - Connected to MQTT broker
2024-07-23 14:48:52 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:48:53 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:49:13 - INFO - received ping from frontend
2024-07-23 14:49:30 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:49:30 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:49:30 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:49:30 - ERROR - Backup Server Starting
2024-07-23 14:49:30 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:49:30 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:49:30 - INFO - stopping pumps
2024-07-23 14:49:30 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:50:22 - INFO - Connected to MQTT broker
2024-07-23 14:50:24 - INFO - Program terminated by user
2024-07-23 14:50:26 - INFO - Connected to MQTT broker
2024-07-23 14:50:29 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:50:29 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:50:36 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:50:36 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:50:36 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:50:36 - ERROR - Backup Server Starting
2024-07-23 14:50:36 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:50:36 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:50:36 - INFO - stopping pumps
2024-07-23 14:50:36 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:50:37 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:50:39 - INFO - Connected to MQTT broker
2024-07-23 14:50:52 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:50:52 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:50:56 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:50:56 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:50:56 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:50:56 - ERROR - Backup Server Starting
2024-07-23 14:50:56 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:50:56 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:50:56 - INFO - stopping pumps
2024-07-23 14:50:56 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:51:40 - INFO - Connected to MQTT broker
2024-07-23 14:51:45 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:51:46 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:52:00 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:52:00 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:52:00 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:52:00 - ERROR - Backup Server Starting
2024-07-23 14:52:00 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:52:00 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:52:01 - INFO - stopping pumps
2024-07-23 14:52:01 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:52:02 - INFO - Sending command: b'2pcu1\n'
2024-07-23 14:52:03 - INFO - Sending command: b'14pcu1\n'
2024-07-23 14:52:36 - INFO - Connected to MQTT broker
2024-07-23 14:52:36 - ERROR - Error in start_server
Unexpected error: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 262, in main
    server = await websockets.serve(
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/server.py", line 1116, in __await_impl__
    server = await self._create_server()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1572, in create_server
    raise OSError(err.errno, msg) from None
OSError: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use

2024-07-23 14:52:36 - ERROR - type of exception: <class 'OSError'>
2024-07-23 14:52:36 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 262, in main
    server = await websockets.serve(
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/server.py", line 1116, in __await_impl__
    server = await self._create_server()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1572, in create_server
    raise OSError(err.errno, msg) from None
OSError: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:52:47 - INFO - Connected to MQTT broker
2024-07-23 14:52:47 - ERROR - Error in start_server
Unexpected error: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 262, in main
    server = await websockets.serve(
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/server.py", line 1116, in __await_impl__
    server = await self._create_server()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1572, in create_server
    raise OSError(err.errno, msg) from None
OSError: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use

2024-07-23 14:52:47 - ERROR - type of exception: <class 'OSError'>
2024-07-23 14:52:47 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 262, in main
    server = await websockets.serve(
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/server.py", line 1116, in __await_impl__
    server = await self._create_server()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1572, in create_server
    raise OSError(err.errno, msg) from None
OSError: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:53:13 - INFO - Connected to MQTT broker
2024-07-23 14:53:13 - ERROR - Error in start_server
Unexpected error: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 262, in main
    server = await websockets.serve(
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/server.py", line 1116, in __await_impl__
    server = await self._create_server()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1572, in create_server
    raise OSError(err.errno, msg) from None
OSError: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use

2024-07-23 14:53:13 - ERROR - type of exception: <class 'OSError'>
2024-07-23 14:53:13 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 262, in main
    server = await websockets.serve(
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/server.py", line 1116, in __await_impl__
    server = await self._create_server()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py", line 1572, in create_server
    raise OSError(err.errno, msg) from None
OSError: [Errno 48] error while attempting to bind on address ('::1', 8765, 0, 0): address already in use

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:53:27 - INFO - Connected to MQTT broker
2024-07-23 14:53:30 - INFO - Program terminated by user
2024-07-23 14:53:41 - INFO - Connected to MQTT broker
2024-07-23 14:53:52 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:53:53 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:54:13 - INFO - received ping from frontend
2024-07-23 14:54:33 - INFO - received ping from frontend
2024-07-23 14:54:50 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:54:56 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:55:00 - ERROR - Error in send_notification: 'NoneType' object has no attribute 'raw'
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 146, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/../../src/resources/error_notification.py", line 17, in send_notification
    print(app.is_authenticated)
          ^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 200, in is_authenticated
    self._authenticate()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 273, in _authenticate
    self._sounds = self._request('sound')[0]['sounds']
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/__init__.py", line 334, in _request
    response = pool.open(url)
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 515, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 532, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/urllib/request.py", line 492, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/chump/connection_pool.py", line 82, in https_open
    if response.raw.will_close:
       ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'raw'

2024-07-23 14:55:56 - INFO - Connected to MQTT broker
2024-07-23 14:56:06 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:56:07 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:56:10 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 147, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:56:10 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
2024-07-23 14:56:10 - ERROR - Backup Server Starting
2024-07-23 14:56:10 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'feed_counter': 0, 'start_counter': 0, 'last_antifoam_edition': 1721761803.304759, 'start_feed': 'True', 'start_phase_1': 'True'}
2024-07-23 14:56:10 - INFO - Loaded control configuration for 2_phase_do_trig_ph_feed_control: {'base_sp': 6.95, 'acid_sp': 8, 'feed_trigger_sp': 7.0, 'start_feed_trig_value': 50, 'start_trig_value': 30, 'required_readings': 3, 'antifoam_edition_rate': 1}
2024-07-23 14:56:10 - INFO - stopping pumps
2024-07-23 14:56:10 - INFO - Sending command: b'0pcu1\n'
2024-07-23 14:56:25 - INFO - Connected to MQTT broker
2024-07-23 14:56:52 - INFO - Message published with mid: 1, properties: Success, reasonCode: []
2024-07-23 14:56:53 - INFO - Message published with mid: 2, properties: Success, reasonCode: []
2024-07-23 14:57:19 - ERROR - Error in handle_client
Unexpected error: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown
Traceback (most recent call last):
  File "/Users/samgupta/Github/control_loop/webapp/backend/api_server.py", line 147, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/samgupta/Github/control_loop/control_loop/lib/python3.12/site-packages/websockets/legacy/protocol.py", line 948, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: sent 1001 (going away) Server shutdown; then received 1001 (going away) Server shutdown

2024-07-23 14:57:19 - ERROR - type of exception: <class 'websockets.exceptions.ConnectionClosedOK'>
