2024-06-26 11:41:28 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 47, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/tasks.py", line 489, in wait_for
    return fut.result()
           ^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-06-26 11:43:10 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 47, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/tasks.py", line 489, in wait_for
    return fut.result()
           ^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-06-26 11:44:23 - INFO - Loaded control constants for test_loop: {'ph_balance_base_sp': 7, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.02, 'ph_maintained_time': 0, 'do_upper_sp': 25, 'do_lower_sp': 21, 'ph_window': 10, 'start_feed': 'False', 'feed_media': 'Lactose', 'test_data': '3_phase_control_test_data', 'csv_name': 'test_sheet'}
2024-06-26 11:44:23 - INFO - sent arduino: b'0'
2024-06-26 11:44:24 - INFO - sent arduino: b'4'
2024-06-26 11:44:25 - INFO - sent arduino: b'2'
2024-06-26 11:44:27 - INFO - sent arduino: b'10'
2024-06-26 11:44:28 - INFO - sent arduino: b'12'
2024-06-26 11:44:29 - INFO - sent arduino: b'14'
2024-06-26 11:44:30 - INFO - test data: {'ph': 6.8, 'do': 67, 'time': 0, 'type': 'data', 'time_of_day': '11:44:30', 'date': '2024-06-26'}
2024-06-26 11:44:32 - INFO - added data to sheets
2024-06-26 11:44:32 - INFO - data sent from collect: {'ph': 6.8, 'do': 67, 'time': 0, 'type': 'data', 'time_of_day': '11:44:30', 'date': '2024-06-26'}
2024-06-26 11:44:36 - INFO - test data: {'ph': 6.9, 'do': 67, 'time': 0.0017829621500439115, 'type': 'data', 'time_of_day': '11:44:36', 'date': '2024-06-26'}
2024-06-26 11:44:38 - INFO - added data to sheets
2024-06-26 11:44:38 - INFO - data sent from collect: {'ph': 6.9, 'do': 67, 'time': 0.0017829621500439115, 'type': 'data', 'time_of_day': '11:44:36', 'date': '2024-06-26'}
2024-06-26 11:44:42 - INFO - test data: {'ph': 6.0, 'do': 67, 'time': 0.0033347913953993055, 'type': 'data', 'time_of_day': '11:44:42', 'date': '2024-06-26'}
2024-06-26 11:44:43 - INFO - added data to sheets
2024-06-26 11:44:43 - INFO - data sent from collect: {'ph': 6.0, 'do': 67, 'time': 0.0033347913953993055, 'type': 'data', 'time_of_day': '11:44:42', 'date': '2024-06-26'}
2024-06-26 11:44:47 - INFO - test data: {'ph': 7.02, 'do': 67, 'time': 0.004816708829667833, 'type': 'data', 'time_of_day': '11:44:47', 'date': '2024-06-26'}
2024-06-26 11:44:48 - INFO - added data to sheets
2024-06-26 11:44:48 - INFO - data sent from collect: {'ph': 7.02, 'do': 67, 'time': 0.004816708829667833, 'type': 'data', 'time_of_day': '11:44:47', 'date': '2024-06-26'}
2024-06-26 11:44:48 - ERROR - Error in send_status_update: 
 Input: {'type': 'status', 'loopID': 'fermentation_loop', 'control_loop_status': 'control_off', 'data_collection_status': 'data_collection_off', 'feed_pump_status': '0', 'lactose_pump_status': '4', 'base_pump_status': '2', 'feed_const_pump_status': '10', 'lactose_const_pump_status': '12', 'acid_pump_status': '14'}, 
 no close frame received or sent
Traceback (most recent call last):
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 137, in main
    await start_server()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 99, in start_server
    await server.wait_closed()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/server.py", line 814, in wait_closed
    await asyncio.shield(self.closed_waiter)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1301, in close_connection
    await self.transfer_data_task
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 963, in transfer_data
    message = await self.read_message()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1033, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1108, in read_data_frame
    frame = await self.read_frame(max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1165, in read_frame
    frame = await Frame.read(
            ^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/framing.py", line 68, in read
    data = await reader(2)
           ^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/streams.py", line 747, in readexactly
    await self._wait_for_data('readexactly')
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/streams.py", line 540, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/manager_server.py", line 134, in send_status_update
    await websocket.send(json.dumps({"type": "status", **status}))
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 635, in send
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 934, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent

2024-06-26 12:54:22 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 0, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:54:22 - ERROR - Error in initialize_pumps: Invalid pump mode
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/src/controllers.py", line 123, in initialize_pumps
    pumps[pump_name] = Pump(name=pump_value)
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/src/devices/pump.py", line 25, in __init__
    raise ValueError("Invalid pump mode")
ValueError: Invalid pump mode

2024-06-26 12:54:22 - ERROR - Error in initialize_status: 'NoneType' object is not iterable
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/src/controllers.py", line 139, in initialize_status
    for pump_name in self.pumps:
TypeError: 'NoneType' object is not iterable

2024-06-26 12:54:22 - ERROR - Error in get_data: 
 data_col_is_on: False, 
'NoneType' object has no attribute 'values'
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/src/controllers.py", line 97, in stop_control
    for pump in self.pumps.values():
                ^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'values'

2024-06-26 12:54:57 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 0, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:54:57 - INFO - sent arduino: b'0'
2024-06-26 12:54:58 - INFO - sent arduino: b'2'
2024-06-26 12:54:59 - INFO - sent arduino: b'14'
2024-06-26 12:55:00 - INFO - sent arduino: b'4'
2024-06-26 12:55:01 - INFO - Updated (('last_antifoam_edition', 0), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 12:55:01 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 0, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:55:19 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 0, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:55:19 - INFO - sent arduino: b'0'
2024-06-26 12:55:20 - INFO - sent arduino: b'2'
2024-06-26 12:55:21 - INFO - sent arduino: b'14'
2024-06-26 12:55:22 - INFO - sent arduino: b'4'
2024-06-26 12:55:23 - INFO - Updated (('last_antifoam_edition', 0), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 12:55:23 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 0, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:55:23 - INFO - sent arduino: b'5'
2024-06-26 12:55:24 - INFO - Antifoam pump activated
2024-06-26 12:55:26 - INFO - sent arduino: b'4'
2024-06-26 12:55:27 - INFO - Updated (('last_antifoam_edition', 1719431726.482798), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 12:55:27 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719431726.482798, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:55:27 - INFO - Antifoam pump deactivated
2024-06-26 12:56:04 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 0, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:56:04 - INFO - sent arduino: b'0'
2024-06-26 12:56:05 - INFO - sent arduino: b'2'
2024-06-26 12:56:06 - INFO - sent arduino: b'14'
2024-06-26 12:56:07 - INFO - sent arduino: b'4'
2024-06-26 12:57:36 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 0, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:57:36 - INFO - sent arduino: b'0'
2024-06-26 12:57:37 - INFO - sent arduino: b'2'
2024-06-26 12:57:38 - INFO - sent arduino: b'14'
2024-06-26 12:57:39 - INFO - sent arduino: b'4'
2024-06-26 12:57:40 - INFO - Updated (('last_antifoam_edition', 1719431860.360109), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 12:57:40 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719431860.360109, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:57:59 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719431860.360109, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 12:57:59 - INFO - sent arduino: b'0'
2024-06-26 12:58:00 - INFO - sent arduino: b'2'
2024-06-26 12:58:01 - INFO - sent arduino: b'14'
2024-06-26 12:58:02 - INFO - sent arduino: b'4'
2024-06-26 13:00:36 - INFO - sent arduino: b'5'
2024-06-26 13:00:39 - INFO - Antifoam pump activated
2024-06-26 13:00:46 - INFO - sent arduino: b'4'
2024-06-26 13:00:57 - INFO - Updated (('last_antifoam_edition', 1719432046.044877), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 13:00:57 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719432046.044877, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 13:01:01 - INFO - Antifoam pump deactivated
2024-06-26 13:03:16 - INFO - sent arduino: b'5'
2024-06-26 13:03:18 - INFO - Antifoam pump activated
2024-06-26 13:03:32 - INFO - sent arduino: b'4'
2024-06-26 13:03:34 - INFO - Updated (('last_antifoam_edition', 1719432208.0726788), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 13:03:34 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719432208.0726788, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 13:03:55 - INFO - Antifoam pump deactivated
2024-06-26 13:04:09 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719432208.0726788, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 13:04:09 - INFO - sent arduino: b'0'
2024-06-26 13:04:10 - INFO - sent arduino: b'2'
2024-06-26 13:04:11 - INFO - sent arduino: b'14'
2024-06-26 13:04:12 - INFO - sent arduino: b'4'
2024-06-26 13:05:29 - INFO - sent arduino: b'5'
2024-06-26 13:05:30 - INFO - Antifoam pump activated
2024-06-26 13:05:32 - INFO - sent arduino: b'4'
2024-06-26 13:05:33 - INFO - Updated (('last_antifoam_edition', 1719432332.509407), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 13:05:33 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719432332.509407, 'antifoam_edition_rate': 0.0333, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 13:05:33 - INFO - Antifoam pump deactivated
2024-06-26 17:13:01 - ERROR - Error in handle_client
Unexpected error: no close frame received or sent
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 963, in transfer_data
    message = await self.read_message()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1033, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1108, in read_data_frame
    frame = await self.read_frame(max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1165, in read_frame
    frame = await Frame.read(
            ^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/framing.py", line 68, in read
    data = await reader(2)
           ^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/streams.py", line 747, in readexactly
    await self._wait_for_data('readexactly')
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/streams.py", line 540, in _wait_for_data
    await self._waiter
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/selector_events.py", line 995, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 54] Connection reset by peer

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 54, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/tasks.py", line 489, in wait_for
    return fut.result()
           ^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent

2024-06-26 17:13:06 - INFO - Command received: start_collection
2024-06-26 17:13:06 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 0, 'antifoam_edition_rate': 1, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 17:13:06 - INFO - sent arduino: b'0'
2024-06-26 17:13:07 - INFO - sent arduino: b'2'
2024-06-26 17:13:08 - INFO - sent arduino: b'14'
2024-06-26 17:13:09 - INFO - sent arduino: b'4'
2024-06-26 17:13:10 - INFO - test data: {'do': 100, 'ph': 7.7, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0, 'date': '2024-06-26', 'time_of_day': '17:13:10', 'type': 'data'}
2024-06-26 17:13:12 - INFO - added data to sheets
2024-06-26 17:13:12 - INFO - data sent from collect: {'do': 100, 'ph': 7.7, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0, 'date': '2024-06-26', 'time_of_day': '17:13:10', 'type': 'data'}
2024-06-26 17:13:14 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 54, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/tasks.py", line 489, in wait_for
    return fut.result()
           ^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-06-26 17:13:14 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 54, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/tasks.py", line 489, in wait_for
    return fut.result()
           ^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-06-26 17:13:14 - ERROR - Backup Server Starting
2024-06-26 17:13:14 - ERROR - Error in send_status_update: 
 Input: {'type': 'status', 'loopID': 'fermentation_loop', 'control_loop_status': 'control_off', 'data_collection_status': 'data_collection_off', 'feed_pump_status': '0', 'base_pump_status': '2', 'acid_pump_status': '14', 'antifoam_pump_status': '4'}, 
 received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/manager_server.py", line 134, in send_status_update
    await websocket.send(json.dumps({"type": "status", **status}))
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 635, in send
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-06-26 17:13:14 - INFO - sent arduino: b'0'
2024-06-26 17:13:15 - INFO - sent arduino: b'2'
2024-06-26 17:13:16 - INFO - sent arduino: b'14'
2024-06-26 17:13:17 - INFO - sent arduino: b'4'
2024-06-26 17:13:18 - INFO - Starting backup server due to critical failure.
2024-06-26 17:13:18 - INFO - back up server running
2024-06-26 17:13:18 - INFO - test data: {'do': 8, 'ph': 6.8, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.0023761272430419924, 'date': '2024-06-26', 'time_of_day': '17:13:18', 'type': 'data'}
2024-06-26 17:13:18 - INFO - Updated (('last_antifoam_edition', 1719447190.030078), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 17:13:18 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719447190.030078, 'antifoam_edition_rate': 1, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 17:13:18 - INFO - ph being balanced at base: 6.95 and acid: 8
2024-06-26 17:13:18 - INFO - sent arduino: b'3'
2024-06-26 17:13:19 - INFO - Updated (('phase_1_start_counter', 1), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 17:13:19 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 1, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719447190.030078, 'antifoam_edition_rate': 1, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 17:13:22 - INFO - added data to sheets
2024-06-26 17:13:26 - INFO - back up server running
2024-06-26 17:13:26 - INFO - test data: {'do': 70, 'ph': 6.9, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.004570662842856513, 'date': '2024-06-26', 'time_of_day': '17:13:26', 'type': 'data'}
2024-06-26 17:13:26 - INFO - ph being balanced at base: 6.95 and acid: 8
2024-06-26 17:13:26 - INFO - sent arduino: b'3'
2024-06-26 17:13:27 - INFO - Updated (('phase_1_start_counter', 0), {}) in controller 2_phase_do_trig_ph_feed_control of loop fermentation_loop
2024-06-26 17:13:27 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719447190.030078, 'antifoam_edition_rate': 1, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'fermentation_2_phase_do_trig_ph_feed_control_loop_06-26-2024'}
2024-06-26 17:13:28 - INFO - sent arduino: b'0'
2024-06-26 17:13:29 - INFO - sent arduino: b'2'
2024-06-26 17:13:30 - INFO - sent arduino: b'14'
2024-06-26 17:23:05 - ERROR - Error in handle_client
Unexpected error: received 1001 (going away); then sent 1001 (going away)
Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 54, in handle_client
    message = await asyncio.wait_for(websocket.recv(), timeout=60)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/tasks.py", line 489, in wait_for
    return fut.result()
           ^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 568, in recv
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 939, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1001 (going away); then sent 1001 (going away)

2024-06-26 17:23:09 - INFO - Command received: start_collection
2024-06-26 17:23:09 - INFO - Loaded control constants for 2_phase_do_trig_ph_feed_control: {'ph_balance_base_sp': 6.95, 'ph_balance_acid_sp': 8, 'feed_trigger_ph': 7.0, 'feed_trigger_do': 50, 'phase_1_start_trig': 30, 'do_maintained_counter': 0, 'phase_1_start_counter': 0, 'required_consecutive_readings': 3, 'last_antifoam_edition': 1719447190.030078, 'antifoam_edition_rate': 1, 'start_feed': 'False', 'start_phase_1': 'False', 'test_data': '2_phase_test_1', 'csv_name': 'test_sheet'}
2024-06-26 17:23:09 - INFO - sent arduino: b'0'
2024-06-26 17:23:10 - INFO - sent arduino: b'2'
2024-06-26 17:23:11 - INFO - sent arduino: b'14'
2024-06-26 17:23:12 - INFO - sent arduino: b'4'
2024-06-26 17:23:13 - INFO - test data: {'do': 70, 'ph': 7.0, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.16750372032324473, 'date': '2024-06-26', 'time_of_day': '17:23:13', 'type': 'data'}
2024-06-26 17:23:16 - INFO - added data to sheets
2024-06-26 17:23:16 - INFO - data sent from collect: {'do': 70, 'ph': 7.0, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.16750372032324473, 'date': '2024-06-26', 'time_of_day': '17:23:13', 'type': 'data'}
2024-06-26 17:23:20 - INFO - test data: {'do': 100.0, 'ph': 7.02, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.16951953278647527, 'date': '2024-06-26', 'time_of_day': '17:23:20', 'type': 'data'}
2024-06-26 17:23:21 - INFO - added data to sheets
2024-06-26 17:23:21 - INFO - data sent from collect: {'do': 100.0, 'ph': 7.02, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.16951953278647527, 'date': '2024-06-26', 'time_of_day': '17:23:20', 'type': 'data'}
2024-06-26 17:23:25 - INFO - test data: {'do': 70, 'ph': 7.1, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.17100489556789397, 'date': '2024-06-26', 'time_of_day': '17:23:25', 'type': 'data'}
2024-06-26 17:23:27 - INFO - added data to sheets
2024-06-26 17:23:27 - INFO - data sent from collect: {'do': 70, 'ph': 7.1, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.17100489556789397, 'date': '2024-06-26', 'time_of_day': '17:23:25', 'type': 'data'}
2024-06-26 17:23:31 - INFO - test data: {'do': 70, 'ph': 7.15, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.17257224334610832, 'date': '2024-06-26', 'time_of_day': '17:23:31', 'type': 'data'}
2024-06-26 17:23:32 - INFO - added data to sheets
2024-06-26 17:23:32 - INFO - data sent from collect: {'do': 70, 'ph': 7.15, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.17257224334610832, 'date': '2024-06-26', 'time_of_day': '17:23:31', 'type': 'data'}
2024-06-26 17:23:36 - INFO - test data: {'do': 80.5, 'ph': 7.2, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.17404604501194423, 'date': '2024-06-26', 'time_of_day': '17:23:36', 'type': 'data'}
2024-06-26 17:23:37 - INFO - added data to sheets
2024-06-26 17:23:37 - INFO - data sent from collect: {'do': 80.5, 'ph': 7.2, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.17404604501194423, 'date': '2024-06-26', 'time_of_day': '17:23:36', 'type': 'data'}
2024-06-26 17:23:41 - INFO - test data: {'do': 7, 'ph': 7.25, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1755051675107744, 'date': '2024-06-26', 'time_of_day': '17:23:41', 'type': 'data'}
2024-06-26 17:23:43 - INFO - added data to sheets
2024-06-26 17:23:43 - INFO - data sent from collect: {'do': 7, 'ph': 7.25, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1755051675107744, 'date': '2024-06-26', 'time_of_day': '17:23:41', 'type': 'data'}
2024-06-26 17:23:47 - INFO - test data: {'do': 7, 'ph': 7.3, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1770110375351376, 'date': '2024-06-26', 'time_of_day': '17:23:47', 'type': 'data'}
2024-06-26 17:23:48 - INFO - added data to sheets
2024-06-26 17:23:48 - INFO - data sent from collect: {'do': 7, 'ph': 7.3, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1770110375351376, 'date': '2024-06-26', 'time_of_day': '17:23:47', 'type': 'data'}
2024-06-26 17:23:52 - INFO - test data: {'do': 8.0, 'ph': 7.3, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1784609278043111, 'date': '2024-06-26', 'time_of_day': '17:23:52', 'type': 'data'}
2024-06-26 17:23:53 - INFO - added data to sheets
2024-06-26 17:23:53 - INFO - data sent from collect: {'do': 8.0, 'ph': 7.3, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1784609278043111, 'date': '2024-06-26', 'time_of_day': '17:23:52', 'type': 'data'}
2024-06-26 17:23:57 - INFO - test data: {'do': 8.5, 'ph': 7.25, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.17990730669763352, 'date': '2024-06-26', 'time_of_day': '17:23:57', 'type': 'data'}
2024-06-26 17:23:58 - INFO - added data to sheets
2024-06-26 17:23:58 - INFO - data sent from collect: {'do': 8.5, 'ph': 7.25, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.17990730669763352, 'date': '2024-06-26', 'time_of_day': '17:23:57', 'type': 'data'}
2024-06-26 17:24:02 - INFO - test data: {'do': 70, 'ph': 7.2, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1813481389151679, 'date': '2024-06-26', 'time_of_day': '17:24:02', 'type': 'data'}
2024-06-26 17:24:04 - INFO - added data to sheets
2024-06-26 17:24:04 - INFO - data sent from collect: {'do': 70, 'ph': 7.2, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1813481389151679, 'date': '2024-06-26', 'time_of_day': '17:24:02', 'type': 'data'}
2024-06-26 17:24:08 - INFO - test data: {'do': 70, 'ph': 6.1, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.18278498503896926, 'date': '2024-06-26', 'time_of_day': '17:24:08', 'type': 'data'}
2024-06-26 17:24:09 - INFO - added data to sheets
2024-06-26 17:24:09 - INFO - data sent from collect: {'do': 70, 'ph': 6.1, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.18278498503896926, 'date': '2024-06-26', 'time_of_day': '17:24:08', 'type': 'data'}
2024-06-26 17:24:13 - INFO - test data: {'do': 70, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.18425369136863284, 'date': '2024-06-26', 'time_of_day': '17:24:13', 'type': 'data'}
2024-06-26 17:24:14 - INFO - added data to sheets
2024-06-26 17:24:14 - INFO - data sent from collect: {'do': 70, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.18425369136863284, 'date': '2024-06-26', 'time_of_day': '17:24:13', 'type': 'data'}
2024-06-26 17:24:18 - INFO - test data: {'do': 10.5, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1856966588894526, 'date': '2024-06-26', 'time_of_day': '17:24:18', 'type': 'data'}
2024-06-26 17:24:19 - INFO - added data to sheets
2024-06-26 17:24:19 - INFO - data sent from collect: {'do': 10.5, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1856966588894526, 'date': '2024-06-26', 'time_of_day': '17:24:18', 'type': 'data'}
2024-06-26 17:24:23 - INFO - test data: {'do': 11.0, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1871528728140725, 'date': '2024-06-26', 'time_of_day': '17:24:23', 'type': 'data'}
2024-06-26 17:24:26 - INFO - added data to sheets
2024-06-26 17:24:26 - INFO - data sent from collect: {'do': 11.0, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1871528728140725, 'date': '2024-06-26', 'time_of_day': '17:24:23', 'type': 'data'}
2024-06-26 17:24:30 - INFO - test data: {'do': 11.5, 'ph': 7.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.18895403643449146, 'date': '2024-06-26', 'time_of_day': '17:24:30', 'type': 'data'}
2024-06-26 17:24:31 - INFO - added data to sheets
2024-06-26 17:24:31 - INFO - data sent from collect: {'do': 11.5, 'ph': 7.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.18895403643449146, 'date': '2024-06-26', 'time_of_day': '17:24:30', 'type': 'data'}
2024-06-26 17:24:35 - INFO - test data: {'do': 12.0, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.19045369108517965, 'date': '2024-06-26', 'time_of_day': '17:24:35', 'type': 'data'}
2024-06-26 17:24:36 - INFO - added data to sheets
2024-06-26 17:24:36 - INFO - data sent from collect: {'do': 12.0, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.19045369108517965, 'date': '2024-06-26', 'time_of_day': '17:24:35', 'type': 'data'}
2024-06-26 17:24:40 - INFO - test data: {'do': 12.5, 'ph': 7.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1919016989072164, 'date': '2024-06-26', 'time_of_day': '17:24:40', 'type': 'data'}
2024-06-26 17:24:42 - INFO - added data to sheets
2024-06-26 17:24:42 - INFO - data sent from collect: {'do': 12.5, 'ph': 7.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.1919016989072164, 'date': '2024-06-26', 'time_of_day': '17:24:40', 'type': 'data'}
2024-06-26 17:24:46 - INFO - test data: {'do': 13.0, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.19334649781386057, 'date': '2024-06-26', 'time_of_day': '17:24:46', 'type': 'data'}
2024-06-26 17:24:47 - INFO - added data to sheets
2024-06-26 17:24:47 - INFO - data sent from collect: {'do': 13.0, 'ph': 6.03, 'temp': 35.936, 'feed_weight': 1512.3, 'lactose_weight': 1064.5, 'base_weight': 672.4, 'acid_weight': 672.4, 'time': 0.19334649781386057, 'date': '2024-06-26', 'time_of_day': '17:24:46', 'type': 'data'}
2024-06-26 17:24:48 - ERROR - Error in send_status_update: 
 Input: {'type': 'status', 'loopID': 'fermentation_loop', 'control_loop_status': 'control_off', 'data_collection_status': 'data_collection_off', 'feed_pump_status': '0', 'base_pump_status': '2', 'acid_pump_status': '14', 'antifoam_pump_status': '4'}, 
 no close frame received or sent
Traceback (most recent call last):
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 159, in main
    await start_server()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/api_server.py", line 120, in start_server
    await server.wait_closed()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/server.py", line 814, in wait_closed
    await asyncio.shield(self.closed_waiter)
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1301, in close_connection
    await self.transfer_data_task
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 963, in transfer_data
    message = await self.read_message()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1033, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1108, in read_data_frame
    frame = await self.read_frame(max_size)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 1165, in read_frame
    frame = await Frame.read(
            ^^^^^^^^^^^^^^^^^
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/framing.py", line 68, in read
    data = await reader(2)
           ^^^^^^^^^^^^^^^
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/streams.py", line 747, in readexactly
    await self._wait_for_data('readexactly')
  File "/Users/mba_sam/anaconda3/lib/python3.11/asyncio/streams.py", line 540, in _wait_for_data
    await self._waiter
asyncio.exceptions.CancelledError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/webapp/backend/manager_server.py", line 134, in send_status_update
    await websocket.send(json.dumps({"type": "status", **status}))
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 635, in send
    await self.ensure_open()
  File "/Users/mba_sam/Github/Nyoka Design Labs/control_loop/control_loop/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 934, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent

